{% load humanize %}
{% if known_people %}
<section class="bulk-add__known-people">
  <h3>Existing people</h3>
    <p>There {{ known_people|pluralize:"is,are" }} {{ known_people|length|apnumber }} candidate{{ known_people|pluralize }} listed in this area already:</p>
  <p>If {{ known_people|pluralize:"this person is,any of these people are" }} not listed on the nomination paper, please mark them as not standing in this specific election.</p>
  <table class="table sopn_adding_table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Party</th>
        <th class="actions">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for person in known_people %}
      <tr>
        <td style="width:33%;">
          <a href="{% url 'person-view' person.pk %}" target="_blank">{{ person }}</a>
          {% if person.other_names.exists %}
          <div class="other-names">
            <p>Also known as:</p>
            <ul class="">
            {% for name in person.other_names.all %}
                <li class="other-name">{{ name }}</li>
            {% endfor %}
            </ul>
          </div>
          {% endif %}
        </td>
        <td>
          {{ person.party.name }}
        </td>
        <td class="actions">
          <ul>
            <li>
              <a href="{% url 'person-update' person.pk %}" class="button secondary tiny">
                Edit candidate
              </a>
            </li>
            <li>
              <a href="{% url 'person-other-name-create' person.pk %}" class="button secondary tiny js-bulk-known-person-alternate-name">
                Nomination paper shows different name variant
              </a>
            </li>
            <li>
              <a data-person-id="{{ person.pk }}" data-post-id="{{ post.slug }}" href="{% url 'candidacy-delete' election=election %}" class="button secondary tiny js-bulk-known-person-not-standing">
                Not standing
              </a>
            </li>
          </ul>

        </td>

        <script type="text/html" class="js-bulk-known-person-alternate-name-form">
          <tr>
            <td colspan="3" class="js-row">
              <form action="" method="post">
                  {% csrf_token %}
                  <p>
                      <label for="alt-name">Name as it appears on nomination paper:</label>
                      <input id="alt-name" name="name" type="text">
                  </p>
                  <p>
                      <input id="alt-source" name="source" type="hidden" value="{{ official_document.source_url }}">
                  </p>
                  <p>
                      <button type="button" class="button secondary js-bulk-known-person-alternate-name-cancel">Cancel</button>
                      <button type="submit" class="button primary">Add alternate name</button>
                  </p>
              </form>
            </td>
          </tr>
        </script>

        <script type="text/html" class="js-bulk-known-person-not-standing-form">
          <tr>
            <td colspan="3" class="js-row">
                <form action="" method="post">
                  {% csrf_token %}
                  <p>
                      Are you sure you want to mark this candidate as not standing?
                      <input id="alt-source" name="source" type="hidden" value="{{ official_document.source_url }}">
                  </p>
                  <p>
                      <button type="button" class="button secondary js-bulk-known-person-not-standing-cancel">Cancel</button>
                      <button type="submit" class="button primary">Mark Not Standing</button>
                  </p>
              </form>
            </td>
          </tr>
        </script>


      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endif %}
